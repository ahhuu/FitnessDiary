**数据安全体系与设置中心重构**

**指令背景：**
当前 App 功能已趋于成熟，但缺乏数据保护机制。本次任务需要同时完成**底层数据备份架构**的搭建与**UI交互层面的重构**，将分散的数据管理功能收纳至统一的“设置中心”。

**核心目标：**
1.  **数据安全内核：** 基于 Android SAF (Storage Access Framework) 实现数据库的**备份与恢复**，确保数据主权。
2.  **交互重构：** 在“我的”页面右上角新增**“设置”入口**，使用 BottomSheetDialog 承载备份、恢复及清除数据功能，移除原页面底部的散装按钮。
3.  **无损迁移准备：** 优化 Room Database 配置，预留 Migration 接口，防止未来升级导致崩溃。

---

### 📋 详细任务清单

#### 1. 核心工具类 (`BackupManager.java`)
创建一个独立的工具类，负责处理文件流与数据库操作。
* **导出逻辑 (`backupDatabase`):**
    * 执行 `PRAGMA wal_checkpoint(FULL)` 确保缓存数据写入磁盘。
    * 使用 `ContentResolver` 将内部数据库文件复制到用户选定的 `Uri`。
* **导入逻辑 (`restoreDatabase`):**
    * 关闭当前数据库连接 (`close()`)。
    * 将用户选定的外部文件流覆盖内部数据库文件。
    * **关键：** 自动清理 `.wal` 和 `.shm` 临时文件，防止数据冲突。
    * 恢复完成后，强制重启应用或提示用户重启。

#### 2. UI 布局重构
* **我的页面 (`fragment_profile.xml`):**
    * **新增入口：** 在头部用户名/头像区域的右上角，添加一个绿色的**齿轮设置按钮** (`ImageButton`, src=`ic_settings`, tint=`primaryColor`)。
    * **移除冗余：** **彻底删除** 页面最底部的“清除所有数据”按钮及其容器。
* **设置弹窗菜单 (`dialog_bottom_settings.xml`) - 新增文件:**
    * 创建一个 `LinearLayout` 垂直布局，作为 `BottomSheetDialog` 的内容。
    * 包含三个风格统一的菜单项（建议高度 56dp，带图标）：
        1.  📥 **备份数据** (Backup Data)
        2.  📤 **恢复数据** (Restore Data)
        3.  🗑️ **清除所有数据** (Clear All Data) - *字体标红以示警告*

#### 3. 逻辑集成 (`ProfileFragment.java`)
* **SAF 回调注册：**
    * 注册 `ActivityResultContracts.CreateDocument` 用于备份。
    * 注册 `ActivityResultContracts.OpenDocument` 用于恢复。
* **设置按钮交互：**
    * 点击右上角齿轮 -> 弹出 `BottomSheetDialog` (加载 `dialog_bottom_settings.xml`)。
* **菜单功能绑定：**
    * **点击“备份”：** 关闭弹窗 -> 启动 CreateDocument -> 调用 `BackupManager.backupDatabase`。
    * **点击“恢复”：** 关闭弹窗 -> 启动 OpenDocument -> 调用 `BackupManager.restoreDatabase`。
    * **点击“清除”：** 关闭弹窗 -> 弹出二次确认 Dialog -> 确认后执行原有的清除逻辑。

#### 4. 数据库升级预备 (`AppDatabase.java`)
* 保留 `addMigrations()` 接口位置，并在注释中说明未来如何编写 Migration 策略，确保后续版本更新时支持“旧备份恢复到新结构”。

---

### 💻 核心代码生成要求

请直接给出以下文件的完整代码：

1.  **`BackupManager.java`**
    *(包含完整的流处理、WAL Checkpoint 及异常捕获)*

2.  **`dialog_bottom_settings.xml`**
    *(现代化的底部菜单布局)*

3.  **`fragment_profile.xml`**
    *(修改后的布局：含右上角设置按钮，已删除底部清除按钮)*

4.  **`ProfileFragment.java`**
    *(包含 BottomSheetDialog 逻辑、SAF 启动器定义及原有清除逻辑的迁移)*

5.  **`AppDatabase.java`**
    *(Room 数据库构建单例，含 Migration 预留注释)*

6.  **`ic_settings.xml` (Vector)**
    *(Material Design 齿轮图标资源)*